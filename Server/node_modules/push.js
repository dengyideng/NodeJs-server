var fs = require('fs'),
    pushPostings = [],
    messageRet = {};

exports.push = function(req, res){
	var postingsStr = fs.readFileSync(BASE_DIR + '/database/postings.json', 'utf8');
	var postings = JSON.parse(postingsStr);

	for(var i = 0; i < 5; i++){
		var mark = true;
		var index = Math.floor(Math.random()*postings.postings.length - 1);
		for(var j = 0; j < pushPostings.length; j++){
			if(postings.postings[index] == pushPostings[j]){
				i --;
				mark = false;
				break;
			}
		}
		if(mark){
			pushPostings.push(postings.postings[index]);
		}
	}

	console.log(pushPostings);

	messageRet.postings = pushPostings;
	//设置response的编码格式
	res.writeHead(200, {'Content-Type' : 'application/json;charset=utf-8'});
    res.write(JSON.stringify(messageRet));
    res.end();

    console.log("postings push success!");
};